<div class="subnav paneLayout bg--white">
    <div class="flat-searchbar monitoring-backlink">
        <div class="search-handler">
            <button class="backlink" ng-click="webPublisherContentLists.changeView('content-lists')"></button>
        </div>
    </div>
    <div class="filter-trigger" title="Filters" ng-click="webPublisherContentLists.filterOpen = !webPublisherContentLists.filterOpen" ng-class="{'filter-trigger--active': webPublisherContentLists.filterOpen}">
        <i class="icon-filter-large"></i>
    </div>
    <h3 class="page-nav-title">{{newList.name}}</h3>
    <button class="btn" ng-disabled="!webPublisherContentLists.listChangeFlag" ng-click="webPublisherContentLists.changeView('content-lists')">Cancel</button>
    <button class="btn btn--primary rightSpace--big" ng-disabled="!webPublisherContentLists.listChangeFlag" ng-click="webPublisherContentLists.saveManualList()" >Save</button>
</div>
<div class="paneLayout paneLayout--headerMargin">
    <div class="paneLayout__leftPane paneContent" ng-class="{'paneLayout__leftPane--open': webPublisherContentLists.filterOpen}">
        <div class="paneContent__header paneContent__header--dark">
            <h3 class="pull-left" translate>Filter Articles</h3>
            <div ng-click="webPublisherContentLists.filterOpen = !webPublisherContentLists.filterOpen" class="close-filter">
                <i class="icon-close-small"></i>
            </div>
        </div>
        <div class="paneContent__content paneContent__content--hasFooter contentPadding">
            <form name="" class="flat">
                <fieldset class="label-light">
                     <div class="item">
                        <label for="term" translate>Search</label>
                        <input type="text" ng-model="newList.filters.term" class="line-input">
                    </div>
                    <div class="item">
                      <label translate>routes</label>
                        <div sd-meta-terms
                            class="data"
                            data-item="webPublisherContentLists"
                            data-field="selectedRoutes"
                            data-list="routes"
                            data-unique="id"
                            data-header="true"
                            data-reload-list="true">
                        </div>
                     </div>

                    <div class="item">
                      <label translate>author</label>
                        <div class="multiple" ng-repeat="item in newList.filters.author track by $index">
                            <input type="text" class="line-input" ng-model="newList.filters.author[$index]">
                            <button
                                type="button"
                                class="btn btn--small"
                                ng-click="webPublisherContentLists.removeAuthor($index)"
                                tooltip="{{:: 'Remove'|translate}}"
                                tooltip-placement="bottom"
                                tooltip-popup-delay="500">
                                <i class="icon-close-small"></i>
                            </button>
                        </div>
                    </div>
                    <button
                        type="button"
                        class="btn btn--primary btn--small"
                        ng-click="webPublisherContentLists.addAuthor()"
                        tooltip="{{:: 'Add author'|translate}}"
                        tooltip-placement="right"
                        tooltip-popup-delay="500">
                        <i class="svg-icon-plus"></i>
                    </button>
                    <div class="item">
                        <label for="publishedAfter" translate>published after</label>
                        <div class="field">
                            <div sd-datepicker data-format="YYYY-MM-DD" name="publishedAfter" id="publishedAfter" ng-model="newList.filters.publishedAfter"></div>
                        </div>
                    </div>
                    <div class="item">
                        <label for="publishedBefore" translate>published before</label>
                        <div class="field">
                            <div sd-datepicker data-format="YYYY-MM-DD" name="publishedBefore" id="publishedBefore" ng-model="newList.filters.publishedBefore"></div>
                        </div>
                    </div>
                    <div class="item">
                        <label translate>metadata</label>
                        <div class="field" ng-if="webPublisherContentLists.metadataList.length>0">
                            <label translate>Name</label>
                            <label translate>Value</label>
                        </div>
                        <div class="multiple" ng-repeat="item in webPublisherContentLists.metadataList">
                            <input type="text" class="line-input" ng-model="item.metaName">
                            <input type="text" class="line-input" ng-model="item.metaValue">
                            <button
                                type="button"
                                class="btn btn--small"
                                ng-click="webPublisherContentLists.removeMetadata($index)"
                                tooltip="{{:: 'Remove'|translate}}"
                                tooltip-placement="bottom"
                                tooltip-popup-delay="500">
                                <i class="icon-close-small"></i>
                            </button>
                        </div>
                    </div>
                    <button
                        type="button"
                        class="btn btn--primary btn--small"
                        ng-click="webPublisherContentLists.addMetadata()"
                        tooltip="{{:: 'Add metadata'|translate}}"
                        tooltip-placement="right"
                        tooltip-popup-delay="500">
                        <i class="svg-icon-plus"></i>
                    </button>
                </fieldset>
            </form>
        </div>
        <div class="paneContent__footer">
            <button class="btn btn--large btn--primary btn--expanded" ng-click="webPublisherContentLists.filterArticles()" translate>Filter</button>
        </div>
    </div>

    <div class="paneLayout__content verticalLayout verticalLayout--directionRow">
        <div class="verticalLayout__element contentPadding" id="manualListArticlesScrolling">
            <h3 class="text--uppercase text--bold text--smallHeading inlineBlock rightSpace--big" translate>All Articles</h3>
            <div class="sd-line-input inlineBlock">
                <input class="sd-line-input__input" type="text" placeholder="search"
                    ng-model='newList.filters.term'
                    ng-model-options='{ debounce: 1000 }'
                    ng-change='webPublisherContentLists.filterArticles()'>
            </div>

            <div ng-if="!webPublisherContentLists.tenantArticles.loading && !webPublisherContentLists.tenantArticles.items.length" class="alert alert-info alert-block">
                <h4 translate>The list is empty</h4>
                <p translate>Please update filter criteria to add articles to the list.</p>
            </div>

            <ul class="flatList"
                infinite-scroll="webPublisherContentLists.loadMoreTenantArticles()"
                infinite-scroll-container="'#manualListArticlesScrolling'"
                dnd-list="webPublisherContentLists.tenantArticles.items"
                dnd-allowed-types="['tenant']"
                >
                <li ng-repeat="article in webPublisherContentLists.tenantArticles.items"
                    dnd-draggable="article"
                    dnd-moved="webPublisherContentLists.tenantArticles.items.splice($index, 1)"
                    dnd-type="article.type"
                    dnd-effect-allowed="move"
                >
                <div class="sd-list-item sd-shadow--z1" ng-class="{&quot;sd-list-item--activated&quot;:itemActive2}">
                    <div class="sd-list-item__border"></div>
                    <div class="sd-list-item__column" ng-if="article.duplicate" sd-tooltip="duplicate">
                        <i class="icon-warning-sign icon--red"></i>
                    </div>
                    <div class="sd-list-item__column sd-list-item__column--grow sd-list-item__column--no-border">
                        <div class="sd-list-item__row">
                            <span class="sd-overflow-ellipsis">{{ :: article.title || article.content.title}}</span>

                        </div>
                        <div class="sd-list-item__row">
                            <time class="noPadding">{{article.updatedAt || article.createdAt || article.content.updatedAt || article.content.createdAt | reldate}}</time><span class="sd-overflow-ellipsis sd-list-item--element-grow"></span><span class="label label--success label--hollow">{{article.route.name || article.content.route.name}}</span>
                        </div>
                    </div>
                </div>
                </li>
            </ul>
            <div ng-if="webPublisherContentLists.tenantArticles.loading" class="topMargin">
                <div class="item-group__loading"></div>
            </div>
        </div>
        <div class="verticalLayout__element verticalLayout__element--border contentPadding dropZone" ng-class="{'dropZone--empty': !newList.items.length, 'dropZone--active': webPublisherContentLists.draggingFlag}">
            <h3 class="text--uppercase text--bold text--smallHeading inlineBlock rightSpace--big" translate>Content List Articles</h3>
            <div class="sd-line-input inlineBlock">
                <input class="sd-line-input__input" type="text" placeholder="search"
                    ng-model='newList.filterQuery.content.title'
                    ng-disabled="webPublisherContentLists.listChangeFlag">
            </div>
            <span class="badge badge--light pull-right" sd-tooltip="number of articles" flow="left">{{newList.items.length}}</span>
            <h2 class="dropZone__heading" ng-if="!newList.items.length">Drag your Articles here</h2>
            <div ng-if="loading">
                <div class="item-group__loading"></div>
            </div>
            <div ng-if="!loading && !newList.items.length" class="alert alert-info alert-block">
                <h4 translate>The list is empty</h4>
                <p translate>Please update filter criteria to add articles to the list.</p>
            </div>

            <ul ng-if="!loading" class="sd-list-item-group sd-list-item-group--space-between-items" style="min-height: 50vh;"
                dnd-list="newList.items"
                dnd-drop="webPublisherContentLists.onDrop(newList, item, index)"
                dnd-inserted="webPublisherContentLists._markDuplicates(newList.items)"
                dnd-allowed-types="['tenant', 'list']"
                >
                <li ng-repeat="article in newList.items | filter:newList.filterQuery"
                    dnd-draggable="article"
                    dnd-moved="webPublisherContentLists.onMoved(newList, $index)"
                    dnd-type="article.type"
                    dnd-effect-allowed="move"
                >
                    <div class="sd-list-item sd-shadow--z1" ng-class="{&quot;sd-list-item--activated&quot;:itemActive2}">
                        <div class="sd-list-item__border"></div>
                        <div class="sd-list-item__column" ng-if="article.duplicate" sd-tooltip="duplicate">
                            <i class="icon-warning-sign icon--red"></i>
                        </div>
                        <div class="sd-list-item__column sd-list-item__column--grow sd-list-item__column--no-border">
                            <div class="sd-list-item__row">
                                <span class="sd-overflow-ellipsis">{{ :: article.title || article.content.title}}</span>

                            </div>
                            <div class="sd-list-item__row">
                                <time class="noPadding">{{article.updatedAt || article.createdAt || article.content.updatedAt || article.content.createdAt | reldate}}</time><span class="sd-overflow-ellipsis sd-list-item--element-grow"></span><span class="label label--success label--hollow">{{article.route.name || article.content.route.name}}</span>
                            </div>
                        </div>
                        <div class="sd-list-item__action-menu">
                            <button ng-if="!article.sticky" ng-click="webPublisherContentLists.removeFromList($index)" title="{{:: 'Delete' | translate }}"><i class="icon-trash"></i></button>
                        </div>
                    </div>
                </li>
            </ul>

        </div>
    </div>
</div>
